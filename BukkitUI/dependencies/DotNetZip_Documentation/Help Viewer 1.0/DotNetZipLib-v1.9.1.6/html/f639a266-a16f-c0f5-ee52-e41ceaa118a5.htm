<?xml version="1.0" encoding="utf-8"?><html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns="http://www.w3.org/1999/xhtml"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><title>RemoveEntry Method (entry)</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><meta name="file" content="f639a266-a16f-c0f5-ee52-e41ceaa118a5" /><xml xmlns:msxsl="urn:schemas-microsoft-com:xslt"><MSHelp:Attr Name="AssetID" Value="M:Ionic.Zip.ZipFile.RemoveEntry(Ionic.Zip.ZipEntry)" /><MSHelp:Keyword Index="A" Term="M:Ionic.Zip.ZipFile.RemoveEntry(Ionic.Zip.ZipEntry)" /><MSHelp:Keyword Index="A" Term="frlrfIonicZipZipFileClassRemoveEntryTopic" /><MSHelp:Keyword Index="K" Term="RemoveEntry method" /><MSHelp:Keyword Index="K" Term="ZipFile.RemoveEntry method" /><MSHelp:Keyword Index="F" Term="RemoveEntry" /><MSHelp:Keyword Index="F" Term="ZipFile.RemoveEntry" /><MSHelp:Keyword Index="F" Term="Ionic.Zip.ZipFile.RemoveEntry" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="Ionic.Zip.dll" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipFile.RemoveEntry" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="Abstract" Value="Removes the given ZipEntry from the zip archive." /></xml><link type="text/css" rel="stylesheet" /><script type="text/javascript"></script><meta name="SelfBranded" content="true" /><meta name="ContentType" content="Reference" /><meta name="Microsoft.Help.TopicVersion" content="100" /><meta name="Microsoft.Help.Keywords" content="RemoveEntry method" /><meta name="Microsoft.Help.Keywords" content="ZipFile.RemoveEntry method" /><meta name="Microsoft.Help.F1" content="RemoveEntry" /><meta name="Microsoft.Help.F1" content="ZipFile.RemoveEntry" /><meta name="Microsoft.Help.F1" content="Ionic.Zip.ZipFile.RemoveEntry" /><meta name="Description" content="Removes the given ZipEntry from the zip archive." /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Ionic.Zip.ZipFile.RemoveEntry(Ionic.Zip.ZipEntry)" /><meta name="Microsoft.Help.TocParent" content="M:Ionic.Zip.ZipFile.RemoveEntry(Ionic.Zip.ZipEntry)" /><meta name="Microsoft.Help.TOCParentTopicVersion" content="100" /><meta name="Microsoft.Help.TocOrder" content="0" /></head><body><div id="control"><span class="productTitle">Ionic Zip Library v1.9.1.6</span><br /><span class="topicTitle">RemoveEntry Method (entry)</span><br /><div id="toolbar"><span id="chickenFeet"><a href="ms-xhelp://?Id=R:Project">Reference</a> ► <a href="ms-xhelp://?Id=N:Ionic.Zip">Ionic.Zip</a> ► <a href="ms-xhelp://?Id=T:Ionic.Zip.ZipFile">ZipFile</a> ► <span class="selflink">RemoveEntry(ZipEntry)</span></span><span id="languageFilter"><select id="languageSelector" onchange="var names = this.value.split(' '); toggleVisibleLanguage(names[1]); lfc.switchLanguage(names[0]); store.set('lang',this.value); store.save();"><option value="CSharp cs" /><option value="VisualBasic vb" /><option value="ManagedCPlusPlus cpp" /></select></span></div></div><div id="main"><span style="color: DarkGray"></span><div class="summary">
               Removes the given <span class="code">ZipEntry</span> from the zip archive.
             </div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Declaration Syntax</div><div class="sectionContent"><div id="syntaxSection"><table class="filter"><tr class="tabs" id="syntaxTabs"><td class="tab" x-lang="CSharp" onclick="toggleClass('syntaxTabs','x-lang','CSharp','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','CSharp','display','block','none');" /><td class="tab" x-lang="VisualBasic" onclick="toggleClass('syntaxTabs','x-lang','VisualBasic','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','VisualBasic','display','block','none');" /><td class="tab" x-lang="ManagedCPlusPlus" onclick="toggleClass('syntaxTabs','x-lang','ManagedCPlusPlus','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','ManagedCPlusPlus','display','block','none');" /></tr></table><div id="syntaxBlocks"><div class="code" x-lang="CSharp"><pre xml:space="preserve">
<span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">RemoveEntry</span>(
	<a href="ms-xhelp://?Id=T:Ionic.Zip.ZipEntry">ZipEntry</a> <span class="parameter">entry</span>
)</pre></div><div class="code" x-lang="VisualBasic"><pre xml:space="preserve">
<span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">RemoveEntry</span> ( _
	<span class="parameter">entry</span> <span class="keyword">As</span> <a href="ms-xhelp://?Id=T:Ionic.Zip.ZipEntry">ZipEntry</a> _
)</pre></div><div class="code" x-lang="ManagedCPlusPlus"><pre xml:space="preserve">
<span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">RemoveEntry</span>(
	<a href="ms-xhelp://?Id=T:Ionic.Zip.ZipEntry">ZipEntry</a>^ <span class="parameter">entry</span>
)</pre></div></div></div></div></div><div id="parameters"><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Parameters</div><div class="sectionContent"><dl paramName="entry"><dt><span class="parameter">entry</span> (<a href="ms-xhelp://?Id=T:Ionic.Zip.ZipEntry">ZipEntry</a>)</dt><dd>
             The <span class="code">ZipEntry</span> to remove from the zip.
             </dd></dl></div></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Remarks</div><div class="sectionContent"><p>
               After calling <span class="code">RemoveEntry</span>, the application must call <span class="code">Save</span> to
               make the changes permanent.
             </p></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Examples</div><div class="sectionContent">
               In this example, all entries in the zip archive dating from before
               December 31st, 2007, are removed from the archive.  This is actually much
               easier if you use the RemoveSelectedEntries method.  But I needed an
               example for RemoveEntry, so here it is.
             <span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre xml:space="preserve">String ZipFileToRead = <span class="highlight-literal">"ArchiveToModify.zip"</span>;
System.DateTime Threshold = <span class="highlight-keyword">new</span> System.DateTime(<span class="highlight-number">2007</span>,<span class="highlight-number">12</span>,<span class="highlight-number">31</span>);
<span class="highlight-keyword">using</span> (ZipFile zip = ZipFile.Read(ZipFileToRead))
{
  var EntriesToRemove = <span class="highlight-keyword">new</span> System.Collections.Generic.List&lt;ZipEntry&gt;();
  <span class="highlight-keyword">foreach</span> (ZipEntry e <span class="highlight-keyword">in</span> zip)
  {
    <span class="highlight-keyword">if</span> (e.LastModified &lt; Threshold)
    {
      <span class="highlight-comment">// We cannot remove the entry from the list, within the context of</span>
      <span class="highlight-comment">// an enumeration of said list.</span>
      <span class="highlight-comment">// So we add the doomed entry to a list to be removed later.</span>
      EntriesToRemove.Add(e);
    }
  }

  <span class="highlight-comment">// actually remove the doomed entries.</span>
  <span class="highlight-keyword">foreach</span> (ZipEntry zombie <span class="highlight-keyword">in</span> EntriesToRemove)
    zip.RemoveEntry(zombie);

  zip.Comment= String.Format(<span class="highlight-literal">"This zip archive was updated at {0}."</span>,
                             System.DateTime.Now.ToString(<span class="highlight-literal">"G"</span>));

  <span class="highlight-comment">// save with a different name</span>
  zip.Save(<span class="highlight-literal">"Archive-Updated.zip"</span>);
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> ZipFileToRead <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"ArchiveToModify.zip"</span>
<span class="highlight-keyword">Dim</span> Threshold <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> DateTime(<span class="highlight-number">2007</span>, <span class="highlight-number">12</span>, <span class="highlight-number">31</span>)
<span class="highlight-keyword">Using</span> zip <span class="highlight-keyword">As</span> ZipFile = ZipFile.Read(ZipFileToRead)
    <span class="highlight-keyword">Dim</span> EntriesToRemove <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> System.Collections.Generic.List(<span class="highlight-keyword">Of</span> ZipEntry)
    <span class="highlight-keyword">Dim</span> e <span class="highlight-keyword">As</span> ZipEntry
    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> e <span class="highlight-keyword">In</span> zip
        <span class="highlight-keyword">If</span> (e.LastModified &lt; Threshold) <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' We cannot remove the entry from the list, within the context of</span>
            <span class="highlight-comment">' an enumeration of said list.</span>
            <span class="highlight-comment">' So we add the doomed entry to a list to be removed later.</span>
            EntriesToRemove.Add(e)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Next</span>

    <span class="highlight-comment">' actually remove the doomed entries.</span>
    <span class="highlight-keyword">Dim</span> zombie <span class="highlight-keyword">As</span> ZipEntry
    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> zombie <span class="highlight-keyword">In</span> EntriesToRemove
        zip.RemoveEntry(zombie)
    <span class="highlight-keyword">Next</span>
    zip.Comment = <span class="highlight-keyword">String</span>.Format(<span class="highlight-literal">"This zip archive was updated at {0}."</span>, DateTime.Now.ToString(<span class="highlight-literal">"G"</span>))
    <span class="highlight-comment">'save as a different name</span>
    zip.Save(<span class="highlight-literal">"Archive-Updated.zip"</span>)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span></pre></div></span></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Exceptions</div><div class="sectionContent"><table class="exceptions"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>
               Thrown if the specified <span class="code">ZipEntry</span> does not exist in the <span class="code">ZipFile</span>.
             <br /></td></tr></table></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> See Also</div><div class="sectionContent"><a href="ms-xhelp://?Id=M:Ionic.Zip.ZipFile.RemoveSelectedEntries(System.String)">RemoveSelectedEntries(String)</a><br /></div></div><p><div id="footer"><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dpchiesa%40hotmail.com?Subject=Ionic Zip Library v1.9.1.6">dpchiesa@hotmail.com</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script><p />Copyright 2009-2011, Dino Chiesa</div>Assembly: <span sdata="assembly">Ionic.Zip</span> (Module: Ionic.Zip) Version: 1.9.1.8 (1.9.1.8)</p></div></body></html>