<?xml version="1.0" encoding="utf-8"?><html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns="http://www.w3.org/1999/xhtml"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><title>LastModified Property </title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><meta name="file" content="febb9391-ee1c-1fe3-01ec-cf721e9ca809" /><xml xmlns:msxsl="urn:schemas-microsoft-com:xslt"><MSHelp:Attr Name="AssetID" Value="P:Ionic.Zip.ZipEntry.LastModified" /><MSHelp:Keyword Index="A" Term="P:Ionic.Zip.ZipEntry.LastModified" /><MSHelp:Keyword Index="A" Term="frlrfIonicZipZipEntryClassLastModifiedTopic" /><MSHelp:Keyword Index="K" Term="LastModified property" /><MSHelp:Keyword Index="K" Term="ZipEntry.LastModified property" /><MSHelp:Keyword Index="F" Term="LastModified" /><MSHelp:Keyword Index="F" Term="ZipEntry.LastModified" /><MSHelp:Keyword Index="F" Term="Ionic.Zip.ZipEntry.LastModified" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="Ionic.Zip.dll" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipEntry.LastModified" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipEntry.get_LastModified" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipEntry.set_LastModified" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="Abstract" Value="The time and date at which the file indicated by the ZipEntry was last modified." /></xml><meta name="SelfBranded" content="true" /><meta name="ContentType" content="Reference" /><meta name="Microsoft.Help.TopicVersion" content="100" /><meta name="Microsoft.Help.Keywords" content="LastModified property" /><meta name="Microsoft.Help.Keywords" content="ZipEntry.LastModified property" /><meta name="Microsoft.Help.F1" content="LastModified" /><meta name="Microsoft.Help.F1" content="ZipEntry.LastModified" /><meta name="Microsoft.Help.F1" content="Ionic.Zip.ZipEntry.LastModified" /><meta name="Description" content="The time and date at which the file indicated by the ZipEntry was last modified." /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><meta name="Microsoft.Help.Id" content="P:Ionic.Zip.ZipEntry.LastModified" /><meta name="Microsoft.Help.TocParent" content="T:Ionic.Zip.ZipEntry" /><meta name="Microsoft.Help.TOCParentTopicVersion" content="100" /><meta name="Microsoft.Help.TocOrder" content="26" /></head><body><div id="control"><span class="productTitle">Ionic Zip Library v1.9.1.6</span><br /><span class="topicTitle">LastModified Property </span><br /><div id="toolbar"><span id="chickenFeet"><a href="ms-xhelp://?Id=R:Project">Reference</a> ► <a href="ms-xhelp://?Id=N:Ionic.Zip">Ionic.Zip</a> ► <a href="ms-xhelp://?Id=T:Ionic.Zip.ZipEntry">ZipEntry</a> ► <span class="selflink">LastModified</span></span><span id="languageFilter"><select id="languageSelector" onchange="var names = this.value.split(' '); toggleVisibleLanguage(names[1]); lfc.switchLanguage(names[0]); store.set('lang',this.value); store.save();"><option value="CSharp cs" /><option value="VisualBasic vb" /><option value="ManagedCPlusPlus cpp" /></select></span></div></div><div id="main"><span style="color: DarkGray"></span><div class="summary">
               The time and date at which the file indicated by the <span class="code">ZipEntry</span> was
               last modified.
             </div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Declaration Syntax</div><div class="sectionContent"><div id="syntaxSection"><table class="filter"><tr class="tabs" id="syntaxTabs"><td class="tab" x-lang="CSharp" onclick="toggleClass('syntaxTabs','x-lang','CSharp','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','CSharp','display','block','none');" /><td class="tab" x-lang="VisualBasic" onclick="toggleClass('syntaxTabs','x-lang','VisualBasic','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','VisualBasic','display','block','none');" /><td class="tab" x-lang="ManagedCPlusPlus" onclick="toggleClass('syntaxTabs','x-lang','ManagedCPlusPlus','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','ManagedCPlusPlus','display','block','none');" /></tr></table><div id="syntaxBlocks"><div class="code" x-lang="CSharp"><pre xml:space="preserve">
<span class="keyword">public</span> <a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a> <span class="identifier">LastModified</span> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</pre></div><div class="code" x-lang="VisualBasic"><pre xml:space="preserve">
<span class="keyword">Public</span> <span class="keyword">Property</span> <span class="identifier">LastModified</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a>
	<span class="keyword">Get</span>
	<span class="keyword">Set</span></pre></div><div class="code" x-lang="ManagedCPlusPlus"><pre xml:space="preserve">
<span class="keyword">public</span>:
<span class="keyword">property</span> <a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a> <span class="identifier">LastModified</span> {
	<a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a> <span class="keyword">get</span> ();
	<span class="keyword">void</span> <span class="keyword">set</span> (<a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a> <span class="parameter">value</span>);
}</pre></div></div></div></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Remarks</div><div class="sectionContent"><p>
               The DotNetZip library sets the LastModified value for an entry, equal to
               the Last Modified time of the file in the filesystem.  If an entry is
               added from a stream, the library uses <span class="code">System.DateTime.Now</span> for this
               value, for the given entry.
             </p><p>
               This property allows the application to retrieve and possibly set the
               LastModified value on an entry, to an arbitrary value.  <a href="http://msdn2.microsoft.com/en-us/library/03ybds8y" target="_blank">DateTime</a> values with a <a href="http://msdn2.microsoft.com/en-us/library/shx7s921" target="_blank">DateTimeKind</a>
               setting of <span class="code">DateTimeKind.Unspecified</span> are taken to be expressed as
               <span class="code">DateTimeKind.Local</span>.
             </p><p>
               Be aware that because of the way <a href="http://www.pkware.com/documents/casestudies/APPNOTE.TXT" target="_blank">PKWare's
               Zip specification</a> describes how times are stored in the zip file,
               the full precision of the <span class="code">System.DateTime</span> datatype is not stored
               for the last modified time when saving zip files.  For more information on
               how times are formatted, see the PKZip specification.
             </p><p>
               The actual last modified time of a file can be stored in multiple ways in
               the zip file, and they are not mutually exclusive:
             </p><ul><li>
                 In the so-called "DOS" format, which has a 2-second precision. Values
                 are rounded to the nearest even second. For example, if the time on the
                 file is 12:34:43, then it will be stored as 12:34:44. This first value
                 is accessible via the <span class="code">LastModified</span> property. This value is always
                 present in the metadata for each zip entry.  In some cases the value is
                 invalid, or zero.
               </li><li>
                 In the so-called "Windows" or "NTFS" format, as an 8-byte integer
                 quantity expressed as the number of 1/10 milliseconds (in other words
                 the number of 100 nanosecond units) since January 1, 1601 (UTC).  This
                 format is how Windows represents file times.  This time is accessible
                 via the <span class="code">ModifiedTime</span> property.
               </li><li>
                 In the "Unix" format, a 4-byte quantity specifying the number of seconds since
                 January 1, 1970 UTC.
               </li><li>
                 In an older format, now deprecated but still used by some current
                 tools. This format is also a 4-byte quantity specifying the number of
                 seconds since January 1, 1970 UTC.
               </li></ul><p>
               Zip tools and libraries will always at least handle (read or write) the
               DOS time, and may also handle the other time formats.  Keep in mind that
               while the names refer to particular operating systems, there is nothing in
               the time formats themselves that prevents their use on other operating
               systems.
             </p><p>
               When reading ZIP files, the DotNetZip library reads the Windows-formatted
               time, if it is stored in the entry, and sets both <span class="code">LastModified</span> and
               <span class="code">ModifiedTime</span> to that value. When writing ZIP files, the DotNetZip
               library by default will write both time quantities. It can also emit the
               Unix-formatted time if desired (See <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.EmitTimesInUnixFormatWhenSaving">EmitTimesInUnixFormatWhenSaving</a>.)
             </p><p>
               The last modified time of the file created upon a call to
               <span class="code">ZipEntry.Extract()</span> may be adjusted during extraction to compensate
               for differences in how the .NET Base Class Library deals with daylight
               saving time (DST) versus how the Windows filesystem deals with daylight
               saving time.  Raymond Chen <a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/24/55413.aspx" target="_blank">provides
               some good context</a>.
             </p><p>
               In a nutshell: Daylight savings time rules change regularly.  In 2007, for
               example, the inception week of DST changed.  In 1977, DST was in place all
               year round. In 1945, likewise.  And so on.  Win32 does not attempt to
               guess which time zone rules were in effect at the time in question.  It
               will render a time as "standard time" and allow the app to change to DST
               as necessary.  .NET makes a different choice.
             </p><p>
               Compare the output of FileInfo.LastWriteTime.ToString("f") with what you
               see in the Windows Explorer property sheet for a file that was last
               written to on the other side of the DST transition. For example, suppose
               the file was last modified on October 17, 2003, during DST but DST is not
               currently in effect. Explorer's file properties reports Thursday, October
               17, 2003, 8:45:38 AM, but .NETs FileInfo reports Thursday, October 17,
               2003, 9:45 AM.
             </p><p>
               Win32 says, "Thursday, October 17, 2002 8:45:38 AM PST". Note: Pacific
               STANDARD Time. Even though October 17 of that year occurred during Pacific
               Daylight Time, Win32 displays the time as standard time because that's
               what time it is NOW.
             </p><p>
               .NET BCL assumes that the current DST rules were in place at the time in
               question.  So, .NET says, "Well, if the rules in effect now were also in
               effect on October 17, 2003, then that would be daylight time" so it
               displays "Thursday, October 17, 2003, 9:45 AM PDT" - daylight time.
             </p><p>
               So .NET gives a value which is more intuitively correct, but is also
               potentially incorrect, and which is not invertible. Win32 gives a value
               which is intuitively incorrect, but is strictly correct.
             </p><p>
               Because of this funkiness, this library adds one hour to the LastModified
               time on the extracted file, if necessary.  That is to say, if the time in
               question had occurred in what the .NET Base Class Library assumed to be
               DST. This assumption may be wrong given the constantly changing DST rules,
               but it is the best we can do.
             </p></div></div><p><div id="footer"><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dpchiesa%40hotmail.com?Subject=Ionic Zip Library v1.9.1.6">dpchiesa@hotmail.com</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script><p />Copyright 2009-2011, Dino Chiesa</div>Assembly: <span sdata="assembly">Ionic.Zip</span> (Module: Ionic.Zip) Version: 1.9.1.8 (1.9.1.8)</p></div></body></html>