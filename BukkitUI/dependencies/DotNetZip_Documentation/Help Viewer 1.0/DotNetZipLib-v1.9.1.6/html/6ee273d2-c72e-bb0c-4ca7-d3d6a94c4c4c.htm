<?xml version="1.0" encoding="utf-8"?><html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns="http://www.w3.org/1999/xhtml"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><title>ProvisionalAlternateEncoding Property </title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><meta name="file" content="6ee273d2-c72e-bb0c-4ca7-d3d6a94c4c4c" /><xml xmlns:msxsl="urn:schemas-microsoft-com:xslt"><MSHelp:Attr Name="AssetID" Value="P:Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><MSHelp:Keyword Index="A" Term="P:Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><MSHelp:Keyword Index="A" Term="frlrfIonicZipZipOutputStreamClassProvisionalAlternateEncodingTopic" /><MSHelp:Keyword Index="K" Term="ProvisionalAlternateEncoding property" /><MSHelp:Keyword Index="K" Term="ZipOutputStream.ProvisionalAlternateEncoding property" /><MSHelp:Keyword Index="F" Term="ProvisionalAlternateEncoding" /><MSHelp:Keyword Index="F" Term="ZipOutputStream.ProvisionalAlternateEncoding" /><MSHelp:Keyword Index="F" Term="Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="Ionic.Zip.dll" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipOutputStream.get_ProvisionalAlternateEncoding" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipOutputStream.set_ProvisionalAlternateEncoding" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="Abstract" Value="The text encoding to use when emitting entries into the zip archive, for those entries whose filenames or comments cannot be encoded with the default (IBM437) encoding." /></xml><meta name="SelfBranded" content="true" /><meta name="ContentType" content="Reference" /><meta name="Microsoft.Help.TopicVersion" content="100" /><meta name="Microsoft.Help.Keywords" content="ProvisionalAlternateEncoding property" /><meta name="Microsoft.Help.Keywords" content="ZipOutputStream.ProvisionalAlternateEncoding property" /><meta name="Microsoft.Help.F1" content="ProvisionalAlternateEncoding" /><meta name="Microsoft.Help.F1" content="ZipOutputStream.ProvisionalAlternateEncoding" /><meta name="Microsoft.Help.F1" content="Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><meta name="Description" content="The text encoding to use when emitting entries into the zip archive, for those entries whose filenames or comments cannot be encoded with the default (IBM437) encoding." /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><meta name="Microsoft.Help.Id" content="P:Ionic.Zip.ZipOutputStream.ProvisionalAlternateEncoding" /><meta name="Microsoft.Help.TocParent" content="T:Ionic.Zip.ZipOutputStream" /><meta name="Microsoft.Help.TOCParentTopicVersion" content="100" /><meta name="Microsoft.Help.TocOrder" content="23" /></head><body><div id="control"><span class="productTitle">Ionic Zip Library v1.9.1.6</span><br /><span class="topicTitle">ProvisionalAlternateEncoding Property </span><br /><div id="toolbar"><span id="chickenFeet"><a href="ms-xhelp://?Id=R:Project">Reference</a> ► <a href="ms-xhelp://?Id=N:Ionic.Zip">Ionic.Zip</a> ► <a href="ms-xhelp://?Id=T:Ionic.Zip.ZipOutputStream">ZipOutputStream</a> ► <span class="selflink">ProvisionalAlternateEncoding</span></span><span id="languageFilter"><select id="languageSelector" onchange="var names = this.value.split(' '); toggleVisibleLanguage(names[1]); lfc.switchLanguage(names[0]); store.set('lang',this.value); store.save();"><option value="CSharp cs" /><option value="VisualBasic vb" /><option value="ManagedCPlusPlus cpp" /></select></span></div></div><div id="main"><span style="color: DarkGray"></span><div class="summary">
               The text encoding to use when emitting entries into the zip archive, for
               those entries whose filenames or comments cannot be encoded with the
               default (IBM437) encoding.
             </div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Declaration Syntax</div><div class="sectionContent"><div id="syntaxSection"><table class="filter"><tr class="tabs" id="syntaxTabs"><td class="tab" x-lang="CSharp" onclick="toggleClass('syntaxTabs','x-lang','CSharp','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','CSharp','display','block','none');" /><td class="tab" x-lang="VisualBasic" onclick="toggleClass('syntaxTabs','x-lang','VisualBasic','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','VisualBasic','display','block','none');" /><td class="tab" x-lang="ManagedCPlusPlus" onclick="toggleClass('syntaxTabs','x-lang','ManagedCPlusPlus','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','ManagedCPlusPlus','display','block','none');" /></tr></table><div id="syntaxBlocks"><div class="code" x-lang="CSharp"><pre xml:space="preserve">
[<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>("use AlternateEncoding and AlternateEncodingUsage instead.")]
<span class="keyword">public</span> <a href="http://msdn2.microsoft.com/en-us/library/86hf4sb8" target="_blank">Encoding</a> <span class="identifier">ProvisionalAlternateEncoding</span> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</pre></div><div class="code" x-lang="VisualBasic"><pre xml:space="preserve">
&lt;<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>("use AlternateEncoding and AlternateEncodingUsage instead.")&gt; _
<span class="keyword">Public</span> <span class="keyword">Property</span> <span class="identifier">ProvisionalAlternateEncoding</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/86hf4sb8" target="_blank">Encoding</a>
	<span class="keyword">Get</span>
	<span class="keyword">Set</span></pre></div><div class="code" x-lang="ManagedCPlusPlus"><pre xml:space="preserve">
[<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>(L"use AlternateEncoding and AlternateEncodingUsage instead.")]
<span class="keyword">public</span>:
<span class="keyword">property</span> <a href="http://msdn2.microsoft.com/en-us/library/86hf4sb8" target="_blank">Encoding</a>^ <span class="identifier">ProvisionalAlternateEncoding</span> {
	<a href="http://msdn2.microsoft.com/en-us/library/86hf4sb8" target="_blank">Encoding</a>^ <span class="keyword">get</span> ();
	<span class="keyword">void</span> <span class="keyword">set</span> (<a href="http://msdn2.microsoft.com/en-us/library/86hf4sb8" target="_blank">Encoding</a>^ <span class="parameter">value</span>);
}</pre></div></div></div></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Remarks</div><div class="sectionContent"><p>
               In <a href="http://www.pkware.com/documents/casestudies/APPNOTE.TXT" target="_blank">its
               zip specification</a>, PKWare describes two options for encoding
               filenames and comments: using IBM437 or UTF-8.  But, some archiving tools
               or libraries do not follow the specification, and instead encode
               characters using the system default code page.  For example, WinRAR when
               run on a machine in Shanghai may encode filenames with the Big-5 Chinese
               (950) code page.  This behavior is contrary to the Zip specification, but
               it occurs anyway.
             </p><p>
               When using DotNetZip to write zip archives that will be read by one of
               these other archivers, set this property to specify the code page to use
               when encoding the <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.FileName">FileName</a> and <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.Comment">Comment</a> for each <span class="code">ZipEntry</span> in the zip file, for
               values that cannot be encoded with the default codepage for zip files,
               IBM437.  This is why this property is "provisional".  In all cases, IBM437
               is used where possible, in other words, where no loss of data would
               result. It is possible, therefore, to have a given entry with a
               <span class="code">Comment</span> encoded in IBM437 and a <span class="code">FileName</span> encoded with the
               specified "provisional" codepage.
             </p><p>
               Be aware that a zip file created after you've explicitly set the
               <span class="code">ProvisionalAlternateEncoding</span> property to a value other than
               IBM437 may not be compliant to the PKWare specification, and may not be
               readable by compliant archivers.  On the other hand, many (most?)
               archivers are non-compliant and can read zip files created in arbitrary
               code pages.  The trick is to use or specify the proper codepage when
               reading the zip.
             </p><p>
               When creating a zip archive using this library, it is possible to change
               the value of <span class="code">ProvisionalAlternateEncoding</span> between each entry you
               add, and between adding entries and the call to <span class="code">Close()</span>. Don't do
               this. It will likely result in a zipfile that is not readable.  For best
               interoperability, either leave <span class="code">ProvisionalAlternateEncoding</span>
               alone, or specify it only once, before adding any entries to the
               <span class="code">ZipOutputStream</span> instance.  There is one exception to this
               recommendation, described later.
             </p><p>
               When using an arbitrary, non-UTF8 code page for encoding, there is no
               standard way for the creator application - whether DotNetZip, WinZip,
               WinRar, or something else - to formally specify in the zip file which
               codepage has been used for the entries. As a result, readers of zip files
               are not able to inspect the zip file and determine the codepage that was
               used for the entries contained within it.  It is left to the application
               or user to determine the necessary codepage when reading zip files encoded
               this way.  If you use an incorrect codepage when reading a zipfile, you
               will get entries with filenames that are incorrect, and the incorrect
               filenames may even contain characters that are not legal for use within
               filenames in Windows. Extracting entries with illegal characters in the
               filenames will lead to exceptions. It's too bad, but this is just the way
               things are with code pages in zip files. Caveat Emptor.
             </p><p>
               One possible approach for specifying the code page for a given zip file is
               to describe the code page in a human-readable form in the Zip comment. For
               example, the comment may read "Entries in this archive are encoded in the
               Big5 code page".  For maximum interoperability, the zip comment in this
               case should be encoded in the default, IBM437 code page.  In this case,
               the zip comment is encoded using a different page than the filenames.  To
               do this, Specify <span class="code">ProvisionalAlternateEncoding</span> to your desired
               region-specific code page, once before adding any entries, and then set
               the <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipOutputStream.Comment">Comment</a> property and reset
               <span class="code">ProvisionalAlternateEncoding</span> to IBM437 before calling <span class="code">Close()</span>.
             </p></div></div><p><div id="footer"><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dpchiesa%40hotmail.com?Subject=Ionic Zip Library v1.9.1.6">dpchiesa@hotmail.com</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script><p />Copyright 2009-2011, Dino Chiesa</div>Assembly: <span sdata="assembly">Ionic.Zip</span> (Module: Ionic.Zip) Version: 1.9.1.8 (1.9.1.8)</p></div></body></html>