<?xml version="1.0" encoding="utf-8"?><html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns="http://www.w3.org/1999/xhtml"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><title>EmitTimesInWindowsFormatWhenSaving Property </title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><script type="text/javascript"></script><meta name="file" content="d5a61123-fc31-b747-6e50-0d25fa627a1f" /><xml xmlns:msxsl="urn:schemas-microsoft-com:xslt"><MSHelp:Attr Name="AssetID" Value="P:Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Keyword Index="A" Term="P:Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Keyword Index="A" Term="frlrfIonicZipZipFileClassEmitTimesInWindowsFormatWhenSavingTopic" /><MSHelp:Keyword Index="K" Term="EmitTimesInWindowsFormatWhenSaving property" /><MSHelp:Keyword Index="K" Term="ZipFile.EmitTimesInWindowsFormatWhenSaving property" /><MSHelp:Keyword Index="F" Term="EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Keyword Index="F" Term="ZipFile.EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Keyword Index="F" Term="Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="Ionic.Zip.dll" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipFile.get_EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Attr Name="APIName" Value="Ionic.Zip.ZipFile.set_EmitTimesInWindowsFormatWhenSaving" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="Abstract" Value="Specifies whether the Creation, Access, and Modified times for entries added to the zip file will be emitted in Windows format when the zip archive is saved." /></xml><link type="text/css" rel="stylesheet" /><script type="text/javascript"></script><meta name="SelfBranded" content="true" /><meta name="ContentType" content="Reference" /><meta name="Microsoft.Help.TopicVersion" content="100" /><meta name="Microsoft.Help.Keywords" content="EmitTimesInWindowsFormatWhenSaving property" /><meta name="Microsoft.Help.Keywords" content="ZipFile.EmitTimesInWindowsFormatWhenSaving property" /><meta name="Microsoft.Help.F1" content="EmitTimesInWindowsFormatWhenSaving" /><meta name="Microsoft.Help.F1" content="ZipFile.EmitTimesInWindowsFormatWhenSaving" /><meta name="Microsoft.Help.F1" content="Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><meta name="Description" content="Specifies whether the Creation, Access, and Modified times for entries added to the zip file will be emitted in Windows format when the zip archive is saved." /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><meta name="Microsoft.Help.Id" content="P:Ionic.Zip.ZipFile.EmitTimesInWindowsFormatWhenSaving" /><meta name="Microsoft.Help.TocParent" content="T:Ionic.Zip.ZipFile" /><meta name="Microsoft.Help.TOCParentTopicVersion" content="100" /><meta name="Microsoft.Help.TocOrder" content="26" /></head><body><div id="control"><span class="productTitle">Ionic Zip Library v1.9.1.6</span><br /><span class="topicTitle">EmitTimesInWindowsFormatWhenSaving Property </span><br /><div id="toolbar"><span id="chickenFeet"><a href="ms-xhelp://?Id=R:Project">Reference</a> ► <a href="ms-xhelp://?Id=N:Ionic.Zip">Ionic.Zip</a> ► <a href="ms-xhelp://?Id=T:Ionic.Zip.ZipFile">ZipFile</a> ► <span class="selflink">EmitTimesInWindowsFormatWhenSaving</span></span><span id="languageFilter"><select id="languageSelector" onchange="var names = this.value.split(' '); toggleVisibleLanguage(names[1]); lfc.switchLanguage(names[0]); store.set('lang',this.value); store.save();"><option value="CSharp cs" /><option value="VisualBasic vb" /><option value="ManagedCPlusPlus cpp" /></select></span></div></div><div id="main"><span style="color: DarkGray"></span><div class="summary">
               Specifies whether the Creation, Access, and Modified times for entries
               added to the zip file will be emitted in Windows format
               when the zip archive is saved.
             </div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Declaration Syntax</div><div class="sectionContent"><div id="syntaxSection"><table class="filter"><tr class="tabs" id="syntaxTabs"><td class="tab" x-lang="CSharp" onclick="toggleClass('syntaxTabs','x-lang','CSharp','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','CSharp','display','block','none');" /><td class="tab" x-lang="VisualBasic" onclick="toggleClass('syntaxTabs','x-lang','VisualBasic','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','VisualBasic','display','block','none');" /><td class="tab" x-lang="ManagedCPlusPlus" onclick="toggleClass('syntaxTabs','x-lang','ManagedCPlusPlus','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','ManagedCPlusPlus','display','block','none');" /></tr></table><div id="syntaxBlocks"><div class="code" x-lang="CSharp"><pre xml:space="preserve">
<span class="keyword">public</span> <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="identifier">EmitTimesInWindowsFormatWhenSaving</span> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</pre></div><div class="code" x-lang="VisualBasic"><pre xml:space="preserve">
<span class="keyword">Public</span> <span class="keyword">Property</span> <span class="identifier">EmitTimesInWindowsFormatWhenSaving</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a>
	<span class="keyword">Get</span>
	<span class="keyword">Set</span></pre></div><div class="code" x-lang="ManagedCPlusPlus"><pre xml:space="preserve">
<span class="keyword">public</span>:
<span class="keyword">property</span> <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="identifier">EmitTimesInWindowsFormatWhenSaving</span> {
	<a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="keyword">get</span> ();
	<span class="keyword">void</span> <span class="keyword">set</span> (<a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="parameter">value</span>);
}</pre></div></div></div></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Remarks</div><div class="sectionContent"><p>
               An application creating a zip archive can use this flag to explicitly
               specify that the file times for the entries should or should not be stored
               in the zip archive in the format used by Windows. By default this flag is
               <span class="code">true</span>, meaning the Windows-format times are stored in the zip
               archive.
             </p><p>
               When adding an entry from a file or directory, the Creation (<a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.CreationTime">CreationTime</a>), Access (<a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.AccessedTime">AccessedTime</a>), and Modified (<a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.ModifiedTime">ModifiedTime</a>) times for the given entry are
               automatically set from the filesystem values. When adding an entry from a
               stream or string, all three values are implicitly set to
               <span class="code">DateTime.Now</span>.  Applications can also explicitly set those times by
               calling <a href="ms-xhelp://?Id=M:Ionic.Zip.ZipEntry.SetEntryTimes(System.DateTime,System.DateTime,System.DateTime)">SetEntryTimes(DateTime, DateTime, DateTime)</a>.
             </p><p><a href="http://www.pkware.com/documents/casestudies/APPNOTE.TXT" target="_blank">PKWARE's
               zip specification</a> describes multiple ways to format these times in a
               zip file. One is the format Windows applications normally use: 100ns ticks
               since January 1, 1601 UTC.  The other is a format Unix applications typically
               use: seconds since January 1, 1970 UTC.  Each format can be stored in an
               "extra field" in the zip entry when saving the zip archive. The former
               uses an extra field with a Header Id of 0x000A, while the latter uses a
               header ID of 0x5455, although you probably don't need to know that.
             </p><p>
               Not all tools and libraries can interpret these fields.  Windows
               compressed folders is one that can read the Windows Format timestamps,
               while I believe <a href="http://www.info-zip.org/" target="_blank">the Infozip
               tools</a> can read the Unix format timestamps. Some tools and libraries
               may be able to read only one or the other. DotNetZip can read or write
               times in either or both formats.
             </p><p>
               The times stored are taken from <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.ModifiedTime">ModifiedTime</a>, <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.AccessedTime">AccessedTime</a>, and <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.CreationTime">CreationTime</a>.
             </p><p>
               The value set here applies to all entries subsequently added to the
               <span class="code">ZipFile</span>.
             </p><p>
               This property is not mutually exclusive of the <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipFile.EmitTimesInUnixFormatWhenSaving">EmitTimesInUnixFormatWhenSaving</a> property. It is possible and
               legal and valid to produce a zip file that contains timestamps encoded in
               the Unix format as well as in the Windows format, in addition to the <a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.LastModified">LastModified</a> time attached to each
               entry in the archive, a time that is always stored in "DOS format". And,
               notwithstanding the names PKWare uses for these time formats, any of them
               can be read and written by any computer, on any operating system.  But,
               there are no guarantees that a program running on Mac or Linux will
               gracefully handle a zip file with "Windows" formatted times, or that an
               application that does not use DotNetZip but runs on Windows will be able to
               handle file times in Unix format.
             </p><p>
               When in doubt, test.  Sorry, I haven't got a complete list of tools and
               which sort of timestamps they can use and will tolerate.  If you get any
               good information and would like to pass it on, please do so and I will
               include that information in this documentation.
             </p></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> Examples</div><div class="sectionContent">
               This example shows how to save a zip file that contains file timestamps
               in a format normally used by Unix.
             <span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">using</span> (var zip = <span class="highlight-keyword">new</span> ZipFile())
{
    <span class="highlight-comment">// produce a zip file the Mac will like</span>
    zip.EmitTimesInWindowsFormatWhenSaving = <span class="highlight-keyword">false</span>;
    zip.EmitTimesInUnixFormatWhenSaving = <span class="highlight-keyword">true</span>;
    zip.AddDirectory(directoryToZip, <span class="highlight-literal">"files"</span>);
    zip.Save(outputFile);
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Using</span> zip <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> ZipFile
    <span class="highlight-comment">'' produce a zip file the Mac will like</span>
    zip.EmitTimesInWindowsFormatWhenSaving = <span class="highlight-keyword">False</span>
    zip.EmitTimesInUnixFormatWhenSaving = <span class="highlight-keyword">True</span>
    zip.AddDirectory(directoryToZip, <span class="highlight-literal">"files"</span>)
    zip.Save(outputFile)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span></pre></div></span></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img /> See Also</div><div class="sectionContent"><a href="ms-xhelp://?Id=P:Ionic.Zip.ZipEntry.EmitTimesInWindowsFormatWhenSaving">EmitTimesInWindowsFormatWhenSaving</a><br /><a href="ms-xhelp://?Id=P:Ionic.Zip.ZipFile.EmitTimesInUnixFormatWhenSaving">EmitTimesInUnixFormatWhenSaving</a><br /></div></div><p><div id="footer"><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:dpchiesa%40hotmail.com?Subject=Ionic Zip Library v1.9.1.6">dpchiesa@hotmail.com</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script><p />Copyright 2009-2011, Dino Chiesa</div>Assembly: <span sdata="assembly">Ionic.Zip</span> (Module: Ionic.Zip) Version: 1.9.1.8 (1.9.1.8)</p></div></body></html>